<!DOCTYPE html>
<html>

	<head>
		<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
		<title>实名认证-X职查</title>
		<meta name="keywords" content="">
		<meta name="description" content="">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
		<link rel="shortcut icon" type="image/png" href="@{'/public/images/favicon.ico'}" />
		<!-- <link rel="stylesheet" type="text/css" href="@{'/public/stylesheets/layui/css/layui.css'}" /> -->
		<link href="@{'/public/stylesheets/webcss/public.css'}" rel="stylesheet" type="text/css" />
		<link href="@{'/public/stylesheets/webcss/style.css'}" rel="stylesheet" type="text/css" />
		<script type="text/javascript" src="/public/javascripts/js/jquery.1.9.1.js"></script>
		<script type="text/javascript" src="@{'/public/javascripts/common.js'}"></script>
	    <script type="text/javascript" src="@{'/public/javascripts/ajaxfileupload.js'}"></script>
	    <script type="text/javascript" src="@{'/public/javascripts/index.js'}"></script>
	    <script type="text/javascript" src="@{'/public/javascripts/jquery.json-2.4.min.js'}"></script>
		<style type="text/css">
		 .select_on{
		     display: block;
		     width: 100%;
    padding-left: 10px;
    padding-right: 30px;
    cursor: pointer;
    border-width: 1px;
    border-style: solid;
    background-color: #fff;
    border-radius: 2px;
    border-color: #e6e6e6;
    height: 38px;
    line-height: 1.3;
		 }
		</style>
	</head>

	<body class="bgf">
		#{include "common/webHeader.html"/}
		<div class="about_content">
			<div class="fl">
				<div class="page_menu">
					<ul>
						<li>
							<a href="@{front.webHome.HomeAction.home()}">首页</a>
						</li>
						<li>/</li>
						<li>
							<a href="@{front.webAccount.AccountHome.home()}">用户中心</a>
						</li>
						<li>/</li>
						<li>
							<a href="#">实名认证</a>
						</li>
					</ul>
				</div>
				<!-- 左边导航区域 -->
	#{include "front/webAccount/AccountHome/homeLeft.control"/}
			</div>
			<div class="fr" id="realName">
				#{if users?.authentication_status==0}<div class="box_options">
					<div class="on">企业实名认证</div>
					<div>个人实名认证</div>
				</div>#{/if}
				#{if users?.authentication_status==4}
				<div class="box_options">
					<div class="on" style="width: 100%;">企业实名认证</div>
				</div>#{/if}
				#{if users?.authentication_status==0}
				<div class="user_fadein">
					<div class="user_fadein_item">
						<div class="font_text_box">
							<p>您可以进行企业认证或个人实名认证。</p>
							<p>两种认证只能进行其中一项。</p>
							<p>认证通过后可以进行查询、上传、申诉等操作。</p>
							<p>企业认证须等待人工审核，个人认证需要姓名、身份证号、手机号实名信息对应可直接通过。</p>
							<p>如果您是要申诉个人信息，必须进行个人认证。</p>
						</div>
							<div class="data_lable">
								<div class="data_lables">
									<p class="fl_names">企业名称</p>
									<div class="fr_input_type">
										<input type="text" name="comName" id="comName" value="" />
										<img src="/public/images/webimg/updata_08.jpg" />
									</div>
									<img src="/public/images/webimg/updata_11.jpg" class="starx" />
								</div>
								<div class="data_lables">
									<p class="fl_names">企业信用代码</p>
									<div class="fr_input_type">
										<input type="text" name="comCreditCode" id="comCreditCode" value="" />
										<img src="/public/images/webimg/updata_08.jpg" />
									</div>
									<img src="/public/images/webimg/updata_11.jpg" class="starx" />
								</div>
								<div class="data_lables">
									<p class="fl_names">地区</p>
									<div class="fr_input_type1">
										<div class="select_box">
											<select  name="company_province" id="company_province" class="select_on">
											<option value="0">请选择</option>
												#{list getComProvince}
												<option value="${_?.id}">${_?.name}</option>
												#{/list}
											</select>
										</div>
										<div class="select_box">
											<select name="company_city" id="company_city"  lay-verify="required" class="select_on">
											<option value="0">请选择</option>
											</select>
										</div>
									</div>
									<img src="/public/images/webimg/updata_11.jpg" />
								</div>
								<div class="data_lables" id="appendBus">
									<p class="fl_names">企业营业执照</p>
									<div class="add" id="addBus" >
										<img src="/public/images/webimg/updata_38.jpg" />
										 <input  style="width: 6.10rem;line-height: 6.5rem;opacity: 0;position: absolute;margin-top: -10%;cursor: pointer;" 
		                             	type="file"  name="imgFile" id="imgFile" mark1="5" mark="businessLicense" onchange="uploadImage(this);" />
										<p>上传<br />营业执照</p>
									</div>
									<img src="/public/images/webimg/updata_11.jpg" class="starx" id="starxBus"/>
									<p class="last_infos" id="lastBus">(可上传多张)</p>
								</div>
								<div class="data_lables">
									<p class="fl_names">HR联系人</p>
									<div class="fr_input_type">
										<input type="text" name="hrName" id="hrName" value="" />
										<img src="/public/images/webimg/updata_08.jpg" />
									</div>
									<img src="/public/images/webimg/updata_11.jpg" class="starx" />
								</div>
								<div class="data_lables">
									<p class="fl_names">联系电话</p>
									<div class="fr_input_type">
										<input type="text" name="hrMobile" id="hrMobile" value="" />
										<img src="/public/images/webimg/updata_08.jpg" />
									</div>
									<img src="/public/images/webimg/updata_11.jpg" class="starx" />
								</div>
								<div class="data_lables" id="appendHr">
									<p class="fl_names">HR工作证明</p>
									<div class="add" id="addHr" >
										<img src="/public/images/webimg/updata_38.jpg" />
										<input  style="width: 6.10rem;line-height: 6.5rem;opacity: 0;position: absolute;margin-top: -10%;cursor: pointer;" 
		                             	type="file"  name="imgFile" id="imgFile1" mark1="4"  mark="hrCertificate" onchange="uploadImage(this);" />
										<p>上传文件</p>
									</div>
									<p class="last_infos" id="lastHr">(可上传工作证明、工牌、名片任意一种)</p>
								</div>
								<p class="footergs">请确保注册手机号和联系电话能够联系到您，否则上传的信息可能被删除。</p>
								<div class="btn_submitts" id="submit">认证</div>
							</div>
					</div>
					<div class="user_fadein_item hide">
						<div class="font_text_box">
							<p>您可以进行企业认证或个人实名认证。</p>
							<p>两种认证只能进行其中一项。</p>
							<p>认证通过后可以进行查询、上传、申诉等操作。</p>
							<p>企业认证须等待人工审核，个人认证需要姓名、身份证号、手机号实名信息对应可直接通过。</p>
							<p>如果您是要申诉个人信息，必须进行个人认证。</p>
						</div>
							<div class="data_lable">
								<div class="data_lables">
									<p class="fl_names">姓名</p>
									<div class="fr_input_type">
										<input type="text" name="perName" id="perName" value="" />
										<img src="/public/images/webimg/updata_08.jpg" />
									</div>
									<img src="/public/images/webimg/updata_11.jpg" class="starx" />
								</div>
								<div class="data_lables">
									<p class="fl_names">身份证号</p>
									<div class="fr_input_type">
										<input type="text" name="id_number" id="id_number" value="" />
										<img src="/public/images/webimg/updata_08.jpg" />
									</div>
									<img src="/public/images/webimg/updata_11.jpg" class="starx" />
								</div>
								<div class="data_lables">
									<p class="fl_names">地区</p>
									<div class="fr_input_type1">
										<div class="select_box">
											<select name="perProvince" id="perProvince" lay-verify="required" class="select_on">
												<option value="0">请选择</option>
												#{list getComProvince}
												<option value="${_?.id}">${_?.name}</option>
												#{/list}
											</select>
										</div>
										<div class="select_box">
											<select name="perCity" id="perCity" lay-verify="required" class="select_on">
												<option value="0">请选择</option>
											</select>
										</div>
									</div>
									<img src="/public/images/webimg/updata_11.jpg" />
								</div>
								<p class="footergs">请确保注册手机号和联系电话能够联系到您，否则上传的信息可能被删除。</p>
								<div class="btn_submitts" id="submit1">认证</div>
							</div>
					</div>
				</div>#{/if}
				#{if users?.authentication_status==4}
				<div class="user_fadein">
					<div class="user_fadein_item">
						<div class="font_text_box">
							<p>您可以进行企业认证或个人实名认证。</p>
							<p>两种认证只能进行其中一项。</p>
							<p>认证通过后可以进行查询、上传、申诉等操作。</p>
							<p>企业认证须等待人工审核，个人认证需要姓名、身份证号、手机号实名信息对应可直接通过。</p>
							<p>如果您是要申诉个人信息，必须进行个人认证。</p>
						</div>
							<div class="data_lable">
								<div class="data_lables">
									<p class="fl_names">企业名称</p>
									<div class="fr_input_type">
										<input type="text" name="comName" id="comName" value="${user?.company_name}" />
										<img src="/public/images/webimg/updata_08.jpg" />
									</div>
									<img src="/public/images/webimg/updata_11.jpg" class="starx" />
								</div>
								<div class="data_lables">
									<p class="fl_names">企业信用代码</p>
									<div class="fr_input_type">
										<input type="text" name="comCreditCode" id="comCreditCode" value="${user?.company_code}" />
										<img src="/public/images/webimg/updata_08.jpg" />
									</div>
									<img src="/public/images/webimg/updata_11.jpg" class="starx" />
								</div>
								<div class="data_lables">
									<p class="fl_names">地区</p>
									<div class="fr_input_type1">
										<div class="select_box">
											<select  name="company_province" id="company_province" class="select_on">
											<option value="0">请选择</option>
												#{list getComProvince}
												<option value="${_?.id}" #{if province?.id==_?.id} selected="selected" #{/if}>${_?.name}</option>
												#{/list}
											</select>
										</div>
										<div class="select_box">
											<select name="company_city" id="company_city" mark="${city?.id}" lay-verify="required" class="select_on">
											<option value="0">请选择</option>
											</select>
										</div>
									</div>
									<img src="/public/images/webimg/updata_11.jpg" />
								</div>
								<div class="data_lables" id="appendBus">
									<p class="fl_names">企业营业执照</p>
									#{list images}
						  #{if _?.upload_images_type_id==5}
									<div class="add_yulan">
									    <img  src="${_?.image_filename}" mark="${_?.upload_images_type_id}"name="businessLicense" style="width: 100%;height: 100%;margin: auto;right: auto;top: auto;"/>
										<p>预览</p>
										<img src="/public/images/webimg/xxx_03.jpg" />
									</div>
									#{/if}
						#{/list}
									<div class="add" id="addBus" >
										<img src="/public/images/webimg/updata_38.jpg" />
										 <input  style="width: 6.10rem;line-height: 6.5rem;opacity: 0;position: absolute;margin-top: -10%;cursor: pointer;" 
		                             	type="file"  name="imgFile" id="imgFile" mark1="5" mark="businessLicense" onchange="uploadImage(this);" />
										<p>上传<br />营业执照</p>
									</div>
									<img src="/public/images/webimg/updata_11.jpg" class="starx" id="starxBus"/>
									<p class="last_infos" id="lastBus">(可上传多张)</p>
								</div>
								<div class="data_lables">
									<p class="fl_names">HR联系人</p>
									<div class="fr_input_type">
										<input type="text" name="hrName" id="hrName" value="${user?.company_hr_name}" />
										<img src="/public/images/webimg/updata_08.jpg" />
									</div>
									<img src="/public/images/webimg/updata_11.jpg" class="starx" />
								</div>
								<div class="data_lables">
									<p class="fl_names">联系电话</p>
									<div class="fr_input_type">
										<input type="text" name="hrMobile" id="hrMobile" value="${user?.hr_mobile}" />
										<img src="/public/images/webimg/updata_08.jpg" />
									</div>
									<img src="/public/images/webimg/updata_11.jpg" class="starx" />
								</div>
								<div class="data_lables" id="appendHr">
									<p class="fl_names">HR工作证明</p>
									#{list images}
						  #{if _?.upload_images_type_id==4}
									<div class="add_yulan">
									    <img  src="${_?.image_filename}" mark="${_?.upload_images_type_id}"name="hrCertificate" style="width: 100%;height: 100%;margin: auto;right: auto;top: auto;"/>
										<p>预览</p>
										<img src="/public/images/webimg/xxx_03.jpg" />
									</div>
							#{/if}
						#{/list}
									<div class="add" id="addHr" >
										<img src="/public/images/webimg/updata_38.jpg" />
										<input  style="width: 6.10rem;line-height: 6.5rem;opacity: 0;position: absolute;margin-top: -10%;cursor: pointer;" 
		                             	type="file"  name="imgFile" id="imgFile1" mark1="4"  mark="hrCertificate" onchange="uploadImage(this);" />
										<p>上传文件</p>
									</div>
									<p class="last_infos" id="lastHr">(可上传工作证明、工牌、名片任意一种)</p>
								</div>
								<p class="footergs">请确保注册手机号和联系电话能够联系到您，否则上传的信息可能被删除。</p>
								<div class="btn_submitts" id="submit">认证</div>
							</div>
					</div>
				</div>#{/if}
			</div>
			<div class="fr" id="state" style="display:none;">
				<div class="teaxs">
					<p id="error">企业认证已提交<br /> 需要1个工作日进行审核！</p>
					<img src="/public/images/webimg/center_16.jpg" />
					<div class="box_btn_links">
						<a href="@{front.webHome.HomeAction.home()}" class="fl_pobtn">去首页</a>
						<a href="@{front.webAccount.AccountHome.home()}" class="fr_pobtn">去我的账户</a>
					</div>
				</div>
			</div>
		</div>
		#{include "common/webBottom.html"/}
		<!--[if !IE]><!-->
	<!-- 	<script src="@{'/public/javascripts/webjs/jquery-2.1.1.min.js'}" type="text/javascript"></script> -->
		<!-- <script type="text/javascript" src="@{'/public/stylesheets/layui/layui.js'}"></script> -->
		<script>
			/* layui.use('form', function() {
				var form = layui.form;
				form.on('submit(formDemo)', function(data) {
					layer.msg(JSON.stringify(data.field));
					return false;
				});
			}); */
			$('.box_options div').click(function() {
				var n = $(this).index();
				$('.user_fadein .user_fadein_item').eq(n).show().siblings().hide();
				$(this).addClass('on').siblings().removeClass('on')
			})
			$('.data_lable .data_lables .fr_input_type input').focus(function(){
	$(this).parents('.fr_input_type').addClass('on')
})
$('.data_lable .data_lables .fr_input_type input').blur(function(){
	$(this).parents('.fr_input_type').removeClass('on')
})
		</script>
		<script type="text/javascript">
		     $(function(){
		       $("#li_7").addClass("on");
		       $("#li_7").prevAll().removeClass("on");
		       $("#li_7").nextAll().removeClass("on");
		       $("#img_7").attr("src","/public/images/webimg/sm_rz.png");
		 })
		 $("#company_province").change(function(){
		  $("#company_city").html("");
		  	getCity($(this).val());  		
           });
             function getCity(id){
			  if(id==""){
			  var html="<option>请选择</option>";
			  $("#company_city").append(html);
			  }
			  $.ajax({
			  url:"@{front.webAccount.AccountHome.getCity()}",
			  type:"POST",
			  data:{
			  parentid:id
			  },
			  success:function(data){
			  var html="";
			  html="<option>请选择</option>";
			  for(var i in data){
			  html+="<option value="+data[i].id+">"+data[i].name+"</option>";
			  }
			 	$("#company_city").append(html); 
			  }
			  });
		 }
		 $("#company_city").click(function(){
		  var val=$("#company_province").val();
		   		if(val==0){
		   		  alert("请选择省份");
		   		}
           });
            var i=0;
      /**
 * 上传图片
 * @param fileElementId
 * @param imageElementId
 */
function uploadImage(element) {
    var fileElementId=element.id;
   var imageElementId=$(element).attr("mark");
   var imgMark=$(element).attr("mark1");
   var parentId=$(element).parent().parent().attr("id");
   var parId=$(element).parent().attr("id");
   var nextId=$(element).parent().next().attr("id");
   var nextsId="";
   if(fileElementId=="imgFile"){
    nextsId=$(element).parent().next().next().attr("id");
   }
	var path = $("#"+fileElementId).val();
	if(path == "") {
		alert("请选择上传的图片");
		return ;
	}
	 $.ajaxFileUpload({
		url :  http_path +"/FileUpload/uploadImage",
		secureuri : false,
		fileElementId : fileElementId,
		dataType : "text",
		success : function(data) {
			data = $.evalJSON(data);
			if (data.code < 0) {
				alert(data.msg);
				return ;
			}
			i+=1;
			$("#"+parId).remove();
            $("#"+nextId).remove();
            var  html="<div class='add_yulan' ><img  src='' name='"+imageElementId+"' mark='"+imgMark+"' id='"+imageElementId+i+"' style='display:none;width: 100%;height: 100%;margin: auto;right: auto;top: auto;''/><p>预览</p><img src='/public/images/webimg/xxx_03.jpg' /></div> ";		
		   html+="<div class='add' id='"+parId+"' ><img src='/public/images/webimg/updata_38.jpg' /><input  style='width: 6.10rem;line-height: 6.5rem;opacity: 0;position: absolute;margin-top: -10%;cursor: pointer;' type='file'  name='imgFile' id='"+fileElementId+"'"+
			 "mark='"+imageElementId+"' mark1='"+imgMark+"' onchange='uploadImage(this);' />";
		 if(fileElementId=="imgFile"){
		 $("#"+nextsId).remove();
           html+="<p>上传<br />营业执照</p></div><img src='/public/images/webimg/updata_11.jpg' class='starx' id='"+nextId+"'/><p class='last_infos' id='"+nextsId+"'>(可上传多张)</p>";
            }else{
           html+="<p>上传文件</p></div><p class='last_infos' id='"+nextId+"'>(可上传工作证明、工牌、名片任意一种)</p>";
            }
			$("#"+parentId).html($("#"+parentId).html()+html);
			$("#" + imageElementId+i).attr("src", data.filename);
			$("#" + imageElementId+i).css("display","block");
			//$("#" + imageElementId).parent().css("display","block");
		},
		error : function(data, status, e) {
			alert("上传图片失败");
		}
	}) 
}
  
		 $("#submit").click(function(){
		      var comName=$("#comName").val();
		      var comCreditCode=$("#comCreditCode").val();
		      var comCiyt_id=$("#company_city").val();
		      var bussrc="";
		      var busmark="";
		      $("img[name='businessLicense']").each(function(){
				bussrc=bussrc+$(this).attr("src")+",";
				busmark=busmark+$(this).attr("mark")+",";
			});
		      var hrName=$("#hrName").val();
		      var hrMobile=$("#hrMobile").val();
		       var hrsrc="";
		      var hrmark="";
		      $("img[name='hrCertificate']").each(function(){
				hrsrc=hrsrc+$(this).attr("src")+",";
				hrmark=hrmark+$(this).attr("mark")+",";
			});
			if(comName==""){
	   		alert("请正确填写企业名称");
			return false;
			}
		  if(comCreditCode==""){
	   		alert("请正确填写企业信用代码");
			return false;
			}
		   if(comCiyt_id==undefined){
	   		alert("请选择企业所在地");
			return false;
			}
		    if(bussrc==""){
	   		alert("请上传企业营业执照照片信息");
		    return false;
		    }
		    if(hrName==""){
	   		alert("请正确填写企业HR联系人");
			return false;
		    }
		    if(hrMobile==""){
	   		alert("请正确填写企业联系电话");
			return false;
		    } 
		    if(hrsrc==""){
	   		alert("请上传HR工作证明照片信息");
		    return false;
		    }
		    var src=bussrc+hrsrc;
			var mark=busmark+hrmark;
			src=src.substring(0,src.length-1);
			mark=mark.substring(0,mark.length-1);
		    $.ajax({
			  url:"@{front.webAccount.AccountHome.comRealname()}",
			  type:"POST",
			  dataType:"JSON",
			  data:{
				  comName:comName,
				  comCreditCode:comCreditCode,
				  comCiyt_id:comCiyt_id,
				  hrName:hrName,
				  hrMobile:hrMobile,
				  src:src,
				  mark:mark
			  },
			  success:function(data){
			  	if(data.code<0){
			  		$("#error").text("企业认证提交失败,系统好像开了点小差");
			  		$("#realName").css("display","none"); 
					 $("#state").css("display","block"); 
			  	}else{
			  		$("#realName").css("display","none"); 
					 $("#state").css("display","block"); 
			  	}
			  }
		  });
		 })
		</script>
		<script type="text/javascript">
		 $("#perProvince").change(function(){
		  $("#perCity").html("");
		  	getperCity($(this).val());  		
           });
             function getperCity(id){
			  if(id==""){
			  var html="<option>请选择</option>";
			  $("#perCity").append(html);
			  }
			  $.ajax({
			  url:"@{front.webAccount.AccountHome.getCity()}",
			  type:"POST",
			  data:{
			  parentid:id
			  },
			  success:function(data){
			  var html="";
			  html="<option>请选择</option>";
			  for(var i in data){
			  html+="<option value="+data[i].id+">"+data[i].name+"</option>";
			  }
			 	$("#perCity").append(html); 
			  }
			  });
		 }
		 $("#perCity").click(function(){
		  var val=$("#perProvince").val();
		   		if(val==0){
		   		  alert("请选择省份");
		   		}
           });
            $("#submit1").click(function(){
		  var perName=$("#perName").val();
		  var id_number=$("#id_number").val();
		  var perCity=$("#perCity").val();
		  if(perName==""){
		  	alert("请正确填写姓名");
		  	return false;
		  }
		  if(id_number==""){
		  	alert("请正确填写身份证号");
		  	return false;
		  }
		  if(perCity==0){
		  	alert("请选择所在地");
		  	return false;
		  }
		   $.ajax({
		  url:"@{front.webAccount.AccountHome.perRealName()}",
		  type:"POST",
		  dataType:"JSON",
		  data:{
		  perName:perName,
		  id_number:id_number,
		  city_id:perCity
		  },
		  success:function(data){
		  	if(data.code<0){
		  		$("#error").text("实名认证失败,系统好像开了点小差");
			  	$("#realName").css("display","none"); 
				$("#state").css("display","block"); 
		  	}else{
		  	$("#error").text("实名认证成功！");
			$("#realName").css("display","none"); 
			$("#state").css("display","block"); 
		  	}
		  }
		  }); 
  });
		</script>
		#{if users?.authentication_status==4}
		<script type="text/javascript">
		          $(function(){
		           var val=$("#company_province").val();
		           var mark=$("#company_city").attr("mark");
		           $("#company_city").html("");
		            $.ajax({
			  url:"@{front.webAccount.AccountHome.getCity()}",
			  type:"POST",
			  data:{
			  parentid:val
			  },
			  success:function(data){
			  var html="";
			  html="<option>请选择</option>";
			  for(var i in data){
			     if(data[i].id==mark){
			      html+="<option value="+data[i].id+" selected='selected'>"+data[i].name+"</option>";
			     }else{
			  html+="<option value="+data[i].id+">"+data[i].name+"</option>";
			     }
			  }
			 	$("#company_city").append(html); 
			  }
			  });
		          })
		</script>
		#{/if}
	</body>

</html>